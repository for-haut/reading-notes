# DevOps实施手册

---

## 目录

* [第一章：持续集成概述](#第一章)

## 内容

### <a href="#第一章" id="第一章">第一章：持续集成概述</a>

持续交付开发、运维、业务：

**开发：**

1. 开发人员需要了解其应用所运行的生产系统的性质。
2. 开发人员应该更多的参与测试工作。
3. 开发人员还需要学习如何监控部署后的应用，并理解运维人员所关心的衡量指标。
4. 开发人员需要和运维人员更好地沟通、协作。

**运维：**

1. 运维人员需要清楚代码的来源及其对系统可能产生的影响。
2. 运维人员需要自动化系统管理方式。
3. 理想情况下，运维人员需要版本化其系统。
4. 无论在哪种运维团队所管理的环境下，运维人员都需要监控整个交付流水线种的一切。
5. 运维人员需要与开发人员更好的沟通、写作。

**业务视角：**

1. 业务需要的是IT所交付应用与服务的状态的可见性
2. 业务需要应用交付团队就客户及终端用户如何使用应用与服务为其提供反馈。

**持续集成十个实践：**

1. 维护同源的代码库（Source Code Management， SCM）同源代码管理
2. 自动化构建
3. 测试自动化（按需构建软件、提供测试服务器、配置测试环境、将软件部署到测试服务器】初始化测试数据以及运行正确的测试脚本）
4. 确保每个人每天都能坚持主线交付。
5. 确保每次提交都在集成服务器构建主线。
6. 保持快速构建。
7. <font color="#0f0">克隆生产环境中的测试。</font>
8. 使任何人都能轻松获得最新的可执行文件。
9. 确保每个人都能看到发生的一切。
10. <font color="#0f0">自动化部署</font>。

持续交付流水线

```
研发 --> 源代码 --> 构建 --> 打包 --> 部署 -->测试环境 --> 类生产环境 -->生产环境

配置：

1. 应用程序
2. 中间件
3. 数据库
```

**持续交付工作：**

编排代码部署、内容、应用、中间件以及环境配置。

| 研发环境 | 测试环境 | 类生产环境 | 生产环境 |
|:-------|:--------|:--------|:--------|
| 持续集成：构建、单元测试、构建 | 持续测试：功能测试、性能测试 | 验收测试 | 持续监控 |

<center>持续交付</center>

**持续交付两个关键点：**

1. 持续交付不是一个流程，而是随时根据需要部署到任何环境中的能力。
2. 持续交付不总是意味着部署完整的应用。部署的可能是完整的应用、一个或多个应用组件、应用内容、应用或中间件配置变更，或是应用部署的目标环境。还可能是这些内容的任意组合。

主流用来获取及管理基础设施即代码的自动化架构：`Chef`、`Puppet`、`Salt`、`Ansible`

**软件定义环境（Software Defined Environment， SDE）**

持续反馈：从交付流水线的每一个功能区域到其左侧区域获取反馈。其目的是对生成的代码进行验证，对于其他开发人员还有其他应用组件的代码所集成的代码进行验证。

**注意：**没有持续反馈，持续集成与交付（几乎）没有任何意义。

实现持续反馈：需要两项DevOps实践：`持续测试`和`持续监控`。

持续测试是通过测试应用与环境的所有方面得以实现，其中包括单不限于以下方面：

* 单元测试
* 功能测试
* 性能测试
* 集成测试
* 系统集成测试
* 安全测试
* 用户验收测试

持续监控需要获取并分析以下四个方面的衡量指标：

* 应用性能
* 系统性能
* 应用用户行为
* 用户情绪


启动成熟度评估的指标：

1. 是否具备快速交付全新的创新型应用以及利用现代化架构的能力
2. 是否具备更新现有应用以适应更快交付与创新的能力
3. 是否具备对有助于成功的那些文化、工具以及流程的适应能力

大多数组织遇到的问题：

1. 识别低效或浪费
2. 识别导致低效或浪费的根本原因
3. 制定计划或实施方案来解决这些根本问题

浪费包括以下方面：

* 不必要的流程步骤
* 不必要的返工
* 不必要的功能
* 创建错误的构建物或流程
* 转换他人创建的构建物结构
* 等待他人采取行动或执行任务
* 等待审批
* 等待平台环境就绪
* 为手动任务创建任务单
* 制造或升级无法提升终端客户价值的构建物
* 手动更新数据或报表向上级汇报
* 状态报告

 绘制价值流程图需要同时审视交付流水线一端进来的需求流以及另一端再生产环境下运行的应用程序。其涵盖：
 
 * 新的需求
 * 需求改进
 * 需求变更
 * 故障修复
 * 政策变化
 * 配置更改
 * 内容更新

 实现持续改进，需要审视以下事项：
 
 * 构建物
 * 利益相关者
 * 环境
 * 流程

 可能产生的浪费的一些情况：
 
 * 流程低效
 * 流程手动
 * 构建物形式错误
 * 利益相关者之间的交接低效
 * 利益相关者无法再流程中执行任务
 * 利益相关者无法根据需要访问构建物
 * 利益相关者在不必要的任务上耗费时间
 * 利益相关者创建不必要的构建物
 * 流程被过度监管

 