# 单元测试

---

## 测试类型

* 单元测试- 依靠模拟输入证实是否是期望的输出来分别的测试函数或者类。
* 集成测试 - 测试若干模块来确保他们像预期的那样工作。
* 功能测试- 在产品本身（例如在浏览器上）对一个场景进行操作，而不考虑内部结构以确保预期的行为。

## 测试工具类型

1. 测试环境（Mocha , Jasmine, Jest, Karma）
2. 测试结构 （Mocha , Jasmine, Jest, Cucumber）
3. 断言函数（Chai, Jasmine, Jest, Unexpected）
4. 生成,显示、监听测试结果（Mocha , Jasmine, JestKarma）
5. 生成,比较组件和数据结构的快照，以确保之前运行的更改是预期的。（Jest,Ava）
6. mocks。(sinon.js) 目前使用最多的mock库，将其分为spies、stub、fake XMLHttpRequest、Fake server、Fake time几种，根据不同的场景进行选择。
7. 生成代码覆盖率报告。（Istanbul, Jest）
8. 浏览器或者类浏览器环境执行控制。（Protractor ,  Nightwatch, Phantom, Casper）

## 单元测试技术的实现原理

1. 测试框架：判断内部是否存在异常，存在则console出对应的text信息
2. 断言库：当actual值与expect值不一样时，就抛出异常，供外部测试框架检测到，这就是为什么有些测试框架可以自由选择断言库的原因，只要可以抛出异常，外部测试框架就可以工作。
3. mock函数：创建一个新的函数，用这个函数来取代原来的函数，同时在这个新函数上添加一些额外的属性，例如called、calledWithArguments等信息

## 如何写单元测试用例，一些好的建议：

* 只考虑测试，不考虑内部实现
* 不要做无谓的断言
* 让每个单元测试保持独立
* 所有的方法都应该写单元测试
* 充分考虑数据的边界条件
* 对重点、复杂、核心代码，重点测试
* 利用AOP(beforeEach、afterEach),减少测试代码数量，避免无用功能
* 使用最合适的断言方式

> TDD  
> 一句话简单来说，就是先写测试，后写功能实现。TDD的目的是通过测试用例来指引实际的功能开发，让开发人员首先站在全局的视角来看待需求。具体定义可以查看维基;

---

> BDD  
> 行为驱动开发要求更多人员参与到软件的开发中来，鼓励开发者、QA、相关业务人员相互协作。BDD是由商业价值来驱动，通过用户接口(例如GUI)理解应用程序。详见维基.
